<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Graph-based orchestration framework for production multi-agent systems"><link href=https://lionagi.ai/reference/api/ rel=canonical><link href=../../for-ai-agents/self-improvement/ rel=prev><link href=../changelog/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>API Reference - LionAGI</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap"><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#api-reference class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=LionAGI class="md-header__button md-logo" aria-label=LionAGI data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.5 17c-.13 0-.26 0-.39.04l-1.61-3.25a2.5 2.5 0 0 0-1.75-4.29c-.13 0-.25 0-.39.04l-1.63-3.25c.48-.45.77-1.08.77-1.79a2.5 2.5 0 0 0-5 0c0 .71.29 1.34.76 1.79L8.64 9.54c-.14-.04-.26-.04-.39-.04a2.5 2.5 0 0 0-1.75 4.29l-1.61 3.25C4.76 17 4.63 17 4.5 17a2.5 2.5 0 0 0 0 5A2.5 2.5 0 0 0 7 19.5c0-.7-.29-1.34-.76-1.79l1.62-3.25c.14.04.26.04.39.04s.25 0 .39-.04l1.63 3.25c-.47.45-.77 1.09-.77 1.79a2.5 2.5 0 0 0 5 0A2.5 2.5 0 0 0 12 17c-.13 0-.26 0-.39.04L10 13.79c.46-.45.75-1.08.75-1.79s-.29-1.34-.75-1.79l1.61-3.25c.13.04.26.04.39.04s.26 0 .39-.04L14 10.21c-.45.45-.75 1.09-.75 1.79a2.5 2.5 0 0 0 2.5 2.5c.13 0 .25 0 .39-.04l1.63 3.25c-.47.45-.77 1.09-.77 1.79a2.5 2.5 0 0 0 5 0 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> LionAGI </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> API Reference </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/khive-ai/lionagi title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> khive-ai/lionagi </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../core-concepts/ class=md-tabs__link> Learn </a> </li> <li class=md-tabs__item> <a href=../../patterns/ class=md-tabs__link> Patterns </a> </li> <li class=md-tabs__item> <a href=../../advanced/ class=md-tabs__link> Build </a> </li> <li class=md-tabs__item> <a href=../../for-ai-agents/ class=md-tabs__link> For AI Agents </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Community </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=LionAGI class="md-nav__button md-logo" aria-label=LionAGI data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.5 17c-.13 0-.26 0-.39.04l-1.61-3.25a2.5 2.5 0 0 0-1.75-4.29c-.13 0-.25 0-.39.04l-1.63-3.25c.48-.45.77-1.08.77-1.79a2.5 2.5 0 0 0-5 0c0 .71.29 1.34.76 1.79L8.64 9.54c-.14-.04-.26-.04-.39-.04a2.5 2.5 0 0 0-1.75 4.29l-1.61 3.25C4.76 17 4.63 17 4.5 17a2.5 2.5 0 0 0 0 5A2.5 2.5 0 0 0 7 19.5c0-.7-.29-1.34-.76-1.79l1.62-3.25c.14.04.26.04.39.04s.25 0 .39-.04l1.63 3.25c-.47.45-.77 1.09-.77 1.79a2.5 2.5 0 0 0 5 0A2.5 2.5 0 0 0 12 17c-.13 0-.26 0-.39.04L10 13.79c.46-.45.75-1.08.75-1.79s-.29-1.34-.75-1.79l1.61-3.25c.13.04.26.04.39.04s.26 0 .39-.04L14 10.21c-.45.45-.75 1.09-.75 1.79a2.5 2.5 0 0 0 2.5 2.5c.13 0 .25 0 .39-.04l1.63 3.25c-.47.45-.77 1.09-.77 1.79a2.5 2.5 0 0 0 5 0 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> LionAGI </label> <div class=md-nav__source> <a href=https://github.com/khive-ai/lionagi title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> khive-ai/lionagi </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../core-concepts/ class=md-nav__link> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../patterns/ class=md-nav__link> <span class=md-ellipsis> Patterns </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../advanced/ class=md-nav__link> <span class=md-ellipsis> Build </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../for-ai-agents/ class=md-nav__link> <span class=md-ellipsis> For AI Agents </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Reference </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Community </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/khive-ai/lionagi/edit/main/docs/reference/api/index.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/khive-ai/lionagi/raw/main/docs/reference/api/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=api-reference>API Reference<a class=headerlink href=#api-reference title="Permanent link">&para;</a></h1> <p>Complete reference for the lionagi public API. All classes documented here are importable from the top-level package:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Branch</span><span class=p>,</span> <span class=n>Session</span><span class=p>,</span> <span class=n>iModel</span><span class=p>,</span> <span class=n>Builder</span><span class=p>,</span> <span class=n>Operation</span>
</span></code></pre></div> <p>Provider API keys are read from environment variables (<code>OPENAI_API_KEY</code>, <code>ANTHROPIC_API_KEY</code>, etc.) or can be passed explicitly.</p> <hr> <h2 id=branch>Branch<a class=headerlink href=#branch title="Permanent link">&para;</a></h2> <p>The primary API surface for lionagi. A <code>Branch</code> manages a single conversation thread with message history, tool registration, and LLM operations.</p> <p><code>Branch</code> inherits from <code>Element</code> (UUID identity + timestamp + metadata) and supports the async context manager protocol.</p> <h3 id=constructor>Constructor<a class=headerlink href=#constructor title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>Branch</span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=o>*</span><span class=p>,</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=n>user</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>messages</span><span class=p>:</span> <span class=n>Pile</span><span class=p>[</span><span class=n>RoledMessage</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=n>system</span><span class=p>:</span> <span class=n>System</span> <span class=o>|</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>system_sender</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>chat_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=n>parse_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=n>imodel</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>                    <span class=c1># deprecated, alias of chat_model</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>FuncTool</span> <span class=o>|</span> <span class=nb>list</span><span class=p>[</span><span class=n>FuncTool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=n>log_config</span><span class=p>:</span> <span class=n>DataLoggerConfig</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=n>system_datetime</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>|</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>    <span class=n>system_template</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>    <span class=n>system_template_context</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=n>logs</span><span class=p>:</span> <span class=n>Pile</span><span class=p>[</span><span class=n>Log</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=n>use_lion_system_message</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>user</code></td> <td><code>SenderRecipient \| None</code></td> <td><code>None</code></td> <td>Owner or sender context for this branch.</td> </tr> <tr> <td><code>name</code></td> <td><code>str \| None</code></td> <td><code>None</code></td> <td>Human-readable name for the branch.</td> </tr> <tr> <td><code>messages</code></td> <td><code>Pile[RoledMessage] \| None</code></td> <td><code>None</code></td> <td>Pre-existing messages to seed the conversation.</td> </tr> <tr> <td><code>system</code></td> <td><code>System \| JsonValue \| None</code></td> <td><code>None</code></td> <td>System message content for the LLM.</td> </tr> <tr> <td><code>system_sender</code></td> <td><code>SenderRecipient \| None</code></td> <td><code>None</code></td> <td>Sender attributed to the system message.</td> </tr> <tr> <td><code>chat_model</code></td> <td><code>iModel \| dict \| None</code></td> <td><code>None</code></td> <td>Primary chat model. Defaults to the provider/model in <code>AppSettings</code>.</td> </tr> <tr> <td><code>parse_model</code></td> <td><code>iModel \| dict \| None</code></td> <td><code>None</code></td> <td>Model for structured parsing. Falls back to <code>chat_model</code>.</td> </tr> <tr> <td><code>imodel</code></td> <td><code>iModel \| None</code></td> <td><code>None</code></td> <td><strong>Deprecated.</strong> Use <code>chat_model</code> instead.</td> </tr> <tr> <td><code>tools</code></td> <td><code>FuncTool \| list[FuncTool] \| None</code></td> <td><code>None</code></td> <td>Tools (functions or <code>Tool</code> objects) to register.</td> </tr> <tr> <td><code>log_config</code></td> <td><code>DataLoggerConfig \| dict \| None</code></td> <td><code>None</code></td> <td>Logging configuration.</td> </tr> <tr> <td><code>system_datetime</code></td> <td><code>bool \| str \| None</code></td> <td><code>None</code></td> <td>Include timestamps in system messages. <code>True</code> for default format, or a <code>strftime</code> string.</td> </tr> <tr> <td><code>system_template</code></td> <td><code>Template \| str \| None</code></td> <td><code>None</code></td> <td>Jinja2 template for the system message.</td> </tr> <tr> <td><code>system_template_context</code></td> <td><code>dict \| None</code></td> <td><code>None</code></td> <td>Variables for rendering the system template.</td> </tr> <tr> <td><code>logs</code></td> <td><code>Pile[Log] \| None</code></td> <td><code>None</code></td> <td>Pre-existing logs.</td> </tr> <tr> <td><code>use_lion_system_message</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>If <code>True</code>, prepends the default Lion system prompt.</td> </tr> </tbody> </table> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Branch</span><span class=p>,</span> <span class=n>iModel</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>branch</span> <span class=o>=</span> <span class=n>Branch</span><span class=p>(</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=n>chat_model</span><span class=o>=</span><span class=n>iModel</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4.1-mini&quot;</span><span class=p>),</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=n>system</span><span class=o>=</span><span class=s2>&quot;You are a helpful research assistant.&quot;</span><span class=p>,</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=p>)</span>
</span></code></pre></div> <h3 id=async-context-manager>Async Context Manager<a class=headerlink href=#async-context-manager title="Permanent link">&para;</a></h3> <p><code>Branch</code> supports <code>async with</code> for automatic log flushing on exit:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>async</span> <span class=k>with</span> <span class=n>Branch</span><span class=p>(</span><span class=n>system</span><span class=o>=</span><span class=s2>&quot;You are helpful.&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>branch</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span><span class=s2>&quot;Hello!&quot;</span><span class=p>)</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=c1># logs are automatically dumped on exit</span>
</span></code></pre></div> <h3 id=properties>Properties<a class=headerlink href=#properties title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>id</code></td> <td><code>UUID</code></td> <td>Unique identifier (inherited from <code>Element</code>).</td> </tr> <tr> <td><code>created_at</code></td> <td><code>float</code></td> <td>Creation timestamp (Unix epoch).</td> </tr> <tr> <td><code>metadata</code></td> <td><code>dict</code></td> <td>Arbitrary metadata dictionary.</td> </tr> <tr> <td><code>system</code></td> <td><code>System \| None</code></td> <td>The system message, if any.</td> </tr> <tr> <td><code>messages</code></td> <td><code>Pile[RoledMessage]</code></td> <td>All messages in the conversation.</td> </tr> <tr> <td><code>logs</code></td> <td><code>Pile[Log]</code></td> <td>All activity logs.</td> </tr> <tr> <td><code>chat_model</code></td> <td><code>iModel</code></td> <td>The primary chat model (read/write).</td> </tr> <tr> <td><code>parse_model</code></td> <td><code>iModel</code></td> <td>The parsing model (read/write).</td> </tr> <tr> <td><code>tools</code></td> <td><code>dict[str, Tool]</code></td> <td>Registered tools, keyed by name.</td> </tr> <tr> <td><code>msgs</code></td> <td><code>MessageManager</code></td> <td>The underlying message manager.</td> </tr> <tr> <td><code>acts</code></td> <td><code>ActionManager</code></td> <td>The underlying action/tool manager.</td> </tr> <tr> <td><code>mdls</code></td> <td><code>iModelManager</code></td> <td>The underlying model manager.</td> </tr> </tbody> </table> <h3 id=methods>Methods<a class=headerlink href=#methods title="Permanent link">&para;</a></h3> <hr> <h4 id=chat>chat<a class=headerlink href=#chat title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>chat</span><span class=p>(</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>    <span class=n>instruction</span><span class=p>:</span> <span class=n>Instruction</span> <span class=o>|</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=n>guidance</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=n>context</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=n>sender</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=n>recipient</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>    <span class=n>request_fields</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>JsonValue</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>response_format</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>progression</span><span class=p>:</span> <span class=n>Progression</span> <span class=o>|</span> <span class=nb>list</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=n>imodel</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>    <span class=n>tool_schemas</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=n>images</span><span class=p>:</span> <span class=nb>list</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=n>image_detail</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;low&quot;</span><span class=p>,</span> <span class=s2>&quot;high&quot;</span><span class=p>,</span> <span class=s2>&quot;auto&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=n>plain_content</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>    <span class=n>return_ins_res_message</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=n>include_token_usage_to_model</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>Instruction</span><span class=p>,</span> <span class=n>AssistantResponse</span><span class=p>]</span>
</span></code></pre></div> <p>Low-level LLM invocation using the current conversation history. Messages are <strong>not</strong> automatically appended to the branch -- use <code>communicate</code> or <code>operate</code> for that.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>instruction</code></td> <td><code>Instruction \| JsonValue</code></td> <td><code>None</code></td> <td>Main user instruction text or data.</td> </tr> <tr> <td><code>guidance</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Additional system/user guidance.</td> </tr> <tr> <td><code>context</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Context data for the model.</td> </tr> <tr> <td><code>sender</code></td> <td><code>ID.Ref</code></td> <td><code>None</code></td> <td>Message sender (defaults to <code>branch.user</code>).</td> </tr> <tr> <td><code>recipient</code></td> <td><code>ID.Ref</code></td> <td><code>None</code></td> <td>Message recipient (defaults to <code>branch.id</code>).</td> </tr> <tr> <td><code>request_fields</code></td> <td><code>list[str] \| dict</code></td> <td><code>None</code></td> <td>Field-level validation hints.</td> </tr> <tr> <td><code>response_format</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Pydantic model for structured responses.</td> </tr> <tr> <td><code>progression</code></td> <td><code>Progression \| list</code></td> <td><code>None</code></td> <td>Custom message ordering.</td> </tr> <tr> <td><code>imodel</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Override the default chat model.</td> </tr> <tr> <td><code>tool_schemas</code></td> <td><code>list[dict]</code></td> <td><code>None</code></td> <td>Tool schemas for function calling.</td> </tr> <tr> <td><code>images</code></td> <td><code>list</code></td> <td><code>None</code></td> <td>Images to include in the prompt.</td> </tr> <tr> <td><code>image_detail</code></td> <td><code>"low" \| "high" \| "auto"</code></td> <td><code>None</code></td> <td>Image detail level.</td> </tr> <tr> <td><code>plain_content</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Plain text content, overrides other content.</td> </tr> <tr> <td><code>return_ins_res_message</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>If <code>True</code>, returns <code>(Instruction, AssistantResponse)</code>. Otherwise returns response content only.</td> </tr> <tr> <td><code>include_token_usage_to_model</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Include token usage in model messages.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>tuple[Instruction, AssistantResponse]</code> -- the instruction and the model's response.</p> <hr> <h4 id=communicate>communicate<a class=headerlink href=#communicate title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>communicate</span><span class=p>(</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=n>instruction</span><span class=p>:</span> <span class=n>Instruction</span> <span class=o>|</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=o>*</span><span class=p>,</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>guidance</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>context</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=n>plain_content</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=n>sender</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>    <span class=n>recipient</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>    <span class=n>progression</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>IDSeq</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=n>response_format</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>    <span class=n>request_fields</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>    <span class=n>chat_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>    <span class=n>parse_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>    <span class=n>skip_validation</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>    <span class=n>images</span><span class=p>:</span> <span class=nb>list</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>    <span class=n>image_detail</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;low&quot;</span><span class=p>,</span> <span class=s2>&quot;high&quot;</span><span class=p>,</span> <span class=s2>&quot;auto&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>    <span class=n>num_parse_retries</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>    <span class=n>clear_messages</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>    <span class=n>include_token_usage_to_model</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span>
</span></code></pre></div> <p>High-level conversational call. Messages <strong>are</strong> automatically added to the branch. Simpler than <code>operate</code> -- no tool invocation.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>instruction</code></td> <td><code>Instruction \| JsonValue</code></td> <td><code>None</code></td> <td>The user's main query.</td> </tr> <tr> <td><code>guidance</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Additional guidance for the model.</td> </tr> <tr> <td><code>context</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Extra context data.</td> </tr> <tr> <td><code>plain_content</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Plain text appended to the instruction.</td> </tr> <tr> <td><code>response_format</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Pydantic model for structured output.</td> </tr> <tr> <td><code>request_fields</code></td> <td><code>dict \| list[str]</code></td> <td><code>None</code></td> <td>Specific fields to extract.</td> </tr> <tr> <td><code>chat_model</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Override the default chat model.</td> </tr> <tr> <td><code>parse_model</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Override the default parse model.</td> </tr> <tr> <td><code>skip_validation</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Return raw string without parsing.</td> </tr> <tr> <td><code>images</code></td> <td><code>list</code></td> <td><code>None</code></td> <td>Images for the context.</td> </tr> <tr> <td><code>image_detail</code></td> <td><code>"low" \| "high" \| "auto"</code></td> <td><code>None</code></td> <td>Image detail level.</td> </tr> <tr> <td><code>num_parse_retries</code></td> <td><code>int</code></td> <td><code>3</code></td> <td>Max parse retries (capped at 5).</td> </tr> <tr> <td><code>clear_messages</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Clear stored messages before sending.</td> </tr> <tr> <td><code>include_token_usage_to_model</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Include token usage in model messages.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>str | BaseModel | dict | None</code> -- raw string, validated model, field dict, or <code>None</code> on parse failure.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Simple text response</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>answer</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span><span class=s2>&quot;What is the capital of France?&quot;</span><span class=p>)</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># Structured response</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=k>class</span><span class=w> </span><span class=nc>Answer</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>city</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>    <span class=s2>&quot;What is the capital of France?&quot;</span><span class=p>,</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>    <span class=n>response_format</span><span class=o>=</span><span class=n>Answer</span><span class=p>,</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=p>)</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>city</span><span class=p>)</span>  <span class=c1># &quot;Paris&quot;</span>
</span></code></pre></div> <hr> <h4 id=operate>operate<a class=headerlink href=#operate title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>operate</span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=o>*</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>instruct</span><span class=p>:</span> <span class=n>Instruct</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>instruction</span><span class=p>:</span> <span class=n>Instruction</span> <span class=o>|</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>guidance</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=n>context</span><span class=p>:</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>sender</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=n>recipient</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>    <span class=n>progression</span><span class=p>:</span> <span class=n>Progression</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=n>chat_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=n>invoke_actions</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>    <span class=n>tool_schemas</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>    <span class=n>images</span><span class=p>:</span> <span class=nb>list</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>    <span class=n>image_detail</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;low&quot;</span><span class=p>,</span> <span class=s2>&quot;high&quot;</span><span class=p>,</span> <span class=s2>&quot;auto&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>    <span class=n>parse_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=n>skip_validation</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>ToolRef</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>    <span class=n>operative</span><span class=p>:</span> <span class=n>Operative</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>    <span class=n>response_format</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>    <span class=n>actions</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>    <span class=n>reason</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=n>call_params</span><span class=p>:</span> <span class=n>AlcallParams</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>    <span class=n>action_strategy</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;sequential&quot;</span><span class=p>,</span> <span class=s2>&quot;concurrent&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;concurrent&quot;</span><span class=p>,</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>    <span class=n>verbose_action</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>    <span class=n>field_models</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>FieldModel</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>    <span class=n>exclude_fields</span><span class=p>:</span> <span class=nb>list</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>    <span class=n>handle_validation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;raise&quot;</span><span class=p>,</span> <span class=s2>&quot;return_value&quot;</span><span class=p>,</span> <span class=s2>&quot;return_none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;return_value&quot;</span><span class=p>,</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>    <span class=n>include_token_usage_to_model</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>|</span> <span class=nb>str</span>
</span></code></pre></div> <p>Full orchestration with optional tool invocation and structured response parsing. Messages <strong>are</strong> automatically added to the conversation.</p> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>instruct</code></td> <td><code>Instruct</code></td> <td><code>None</code></td> <td>Instruction bundle (instruction + guidance + context).</td> </tr> <tr> <td><code>instruction</code></td> <td><code>Instruction \| JsonValue</code></td> <td><code>None</code></td> <td>Direct instruction (alternative to <code>instruct</code>).</td> </tr> <tr> <td><code>guidance</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Additional guidance.</td> </tr> <tr> <td><code>context</code></td> <td><code>JsonValue</code></td> <td><code>None</code></td> <td>Context data.</td> </tr> <tr> <td><code>chat_model</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Override chat model.</td> </tr> <tr> <td><code>invoke_actions</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Automatically invoke tools from LLM response.</td> </tr> <tr> <td><code>tools</code></td> <td><code>ToolRef</code></td> <td><code>None</code></td> <td>Tools to make available.</td> </tr> <tr> <td><code>response_format</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Pydantic model for the response.</td> </tr> <tr> <td><code>actions</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Signal that function-calling is expected.</td> </tr> <tr> <td><code>reason</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Request chain-of-thought reasoning.</td> </tr> <tr> <td><code>action_strategy</code></td> <td><code>"sequential" \| "concurrent"</code></td> <td><code>"concurrent"</code></td> <td>Tool invocation strategy.</td> </tr> <tr> <td><code>skip_validation</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Skip response parsing/validation.</td> </tr> <tr> <td><code>handle_validation</code></td> <td><code>"raise" \| "return_value" \| "return_none"</code></td> <td><code>"return_value"</code></td> <td>Behavior on parse failure.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>list | BaseModel | None | dict | str</code> -- parsed response, raw text, or <code>None</code> depending on validation settings.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>class</span><span class=w> </span><span class=nc>AnalysisReport</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>summary</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>key_findings</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>confidence</span><span class=p>:</span> <span class=nb>float</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=n>report</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>operate</span><span class=p>(</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Analyze the quarterly revenue data.&quot;</span><span class=p>,</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>context</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;revenue&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>140</span><span class=p>]},</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>response_format</span><span class=o>=</span><span class=n>AnalysisReport</span><span class=p>,</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>reason</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=nb>print</span><span class=p>(</span><span class=n>report</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=parse>parse<a class=headerlink href=#parse title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>parse</span><span class=p>(</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=n>handle_validation</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;raise&quot;</span><span class=p>,</span> <span class=s2>&quot;return_value&quot;</span><span class=p>,</span> <span class=s2>&quot;return_none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;return_value&quot;</span><span class=p>,</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=n>max_retries</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=n>request_type</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>    <span class=n>operative</span><span class=p>:</span> <span class=n>Operative</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>    <span class=n>similarity_algo</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;jaro_winkler&quot;</span><span class=p>,</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=n>similarity_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.85</span><span class=p>,</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=n>fuzzy_match</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=n>handle_unmatched</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;ignore&quot;</span><span class=p>,</span> <span class=s2>&quot;raise&quot;</span><span class=p>,</span> <span class=s2>&quot;remove&quot;</span><span class=p>,</span> <span class=s2>&quot;fill&quot;</span><span class=p>,</span> <span class=s2>&quot;force&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;force&quot;</span><span class=p>,</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>    <span class=n>fill_value</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>    <span class=n>fill_mapping</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>    <span class=n>strict</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=n>suppress_conversion_errors</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=n>response_format</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseModel</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>|</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span>
</span></code></pre></div> <p>Parses raw text into a structured Pydantic model using the parse model. Supports fuzzy key matching for malformed LLM output. Does <strong>not</strong> append messages to the conversation.</p> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>text</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Raw text to parse.</td> </tr> <tr> <td><code>request_type</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Target Pydantic model.</td> </tr> <tr> <td><code>response_format</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Alias for <code>request_type</code>.</td> </tr> <tr> <td><code>handle_validation</code></td> <td><code>"raise" \| "return_value" \| "return_none"</code></td> <td><code>"return_value"</code></td> <td>Behavior on parse failure.</td> </tr> <tr> <td><code>max_retries</code></td> <td><code>int</code></td> <td><code>3</code></td> <td>Retry count for failed parses.</td> </tr> <tr> <td><code>fuzzy_match</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Attempt fuzzy key matching.</td> </tr> <tr> <td><code>similarity_threshold</code></td> <td><code>float</code></td> <td><code>0.85</code></td> <td>Threshold for fuzzy matching (0.0-1.0).</td> </tr> <tr> <td><code>handle_unmatched</code></td> <td><code>"ignore" \| "raise" \| "remove" \| "fill" \| "force"</code></td> <td><code>"force"</code></td> <td>Policy for unrecognized fields.</td> </tr> <tr> <td><code>strict</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Raise on ambiguous types/fields.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>BaseModel | dict | str | None</code></p> <hr> <h4 id=react>ReAct<a class=headerlink href=#react title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>ReAct</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>instruct</span><span class=p>:</span> <span class=n>Instruct</span> <span class=o>|</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>interpret</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>interpret_domain</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>interpret_style</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>interpret_sample</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>interpret_model</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=n>interpret_kwargs</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>    <span class=n>tool_schemas</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>    <span class=n>response_format</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>    <span class=n>intermediate_response_options</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>BaseModel</span><span class=p>]</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>    <span class=n>intermediate_listable</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>    <span class=n>reasoning_effort</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;low&quot;</span><span class=p>,</span> <span class=s2>&quot;medium&quot;</span><span class=p>,</span> <span class=s2>&quot;high&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>    <span class=n>extension_allowed</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>    <span class=n>max_extensions</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>    <span class=n>response_kwargs</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>    <span class=n>display_as</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;json&quot;</span><span class=p>,</span> <span class=s2>&quot;yaml&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;yaml&quot;</span><span class=p>,</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>    <span class=n>return_analysis</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a>    <span class=n>analysis_model</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a>    <span class=n>verbose_length</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a>    <span class=n>include_token_usage_to_model</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span> <span class=o>|</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=nb>list</span><span class=p>]</span>
</span></code></pre></div> <p>Multi-step Reason + Act loop. Iteratively generates chain-of-thought analysis, invokes tools, and optionally extends the reasoning for additional steps. Messages are automatically added to the branch.</p> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>instruct</code></td> <td><code>Instruct \| dict</code></td> <td><em>(required)</em></td> <td>Instruction with <code>instruction</code>, <code>guidance</code>, and <code>context</code> keys.</td> </tr> <tr> <td><code>interpret</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Pre-process the instruction through <code>interpret()</code>.</td> </tr> <tr> <td><code>interpret_domain</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Domain hint for interpretation (e.g., <code>"finance"</code>).</td> </tr> <tr> <td><code>interpret_style</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Style hint (e.g., <code>"concise"</code>, <code>"detailed"</code>).</td> </tr> <tr> <td><code>tools</code></td> <td><code>Any</code></td> <td><code>None</code></td> <td>Tools to use. <code>None</code> defaults to all registered tools.</td> </tr> <tr> <td><code>response_format</code></td> <td><code>type[BaseModel]</code></td> <td><code>None</code></td> <td>Final output schema.</td> </tr> <tr> <td><code>extension_allowed</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Allow multi-step expansion.</td> </tr> <tr> <td><code>max_extensions</code></td> <td><code>int</code></td> <td><code>3</code></td> <td>Max expansion steps (capped at 5).</td> </tr> <tr> <td><code>return_analysis</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Also return intermediate analysis objects.</td> </tr> <tr> <td><code>analysis_model</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Override model for analysis steps.</td> </tr> <tr> <td><code>reasoning_effort</code></td> <td><code>"low" \| "medium" \| "high"</code></td> <td><code>None</code></td> <td>Reasoning depth hint.</td> </tr> <tr> <td><code>verbose</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Log detailed analysis and action info.</td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <ul> <li>If <code>return_analysis=False</code>: the final output (string, dict, or BaseModel).</li> <li>If <code>return_analysis=True</code>: <code>tuple[final_output, list[ReActAnalysis]]</code>.</li> </ul> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>def</span><span class=w> </span><span class=nf>search</span><span class=p>(</span><span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Search the web for information.&quot;&quot;&quot;</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Results for: </span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=n>branch</span> <span class=o>=</span> <span class=n>Branch</span><span class=p>(</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=n>system</span><span class=o>=</span><span class=s2>&quot;You are a research assistant.&quot;</span><span class=p>,</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>    <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>search</span><span class=p>],</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=p>)</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>ReAct</span><span class=p>(</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>    <span class=n>instruct</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;instruction&quot;</span><span class=p>:</span> <span class=s2>&quot;Find the population of Tokyo&quot;</span><span class=p>},</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>    <span class=n>max_extensions</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=reactstream>ReActStream<a class=headerlink href=#reactstream title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>ReActStream</span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>instruct</span><span class=p>:</span> <span class=n>Instruct</span> <span class=o>|</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=c1># ... same parameters as ReAct ...</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>AsyncGenerator</span>
</span></code></pre></div> <p>Streaming variant of <code>ReAct</code>. Yields intermediate <code>ReActAnalysis</code> objects as each reasoning step completes.</p> <p><strong>Returns:</strong> <code>AsyncGenerator</code> yielding analysis results per step.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>async</span> <span class=k>for</span> <span class=n>step</span> <span class=ow>in</span> <span class=n>branch</span><span class=o>.</span><span class=n>ReActStream</span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=n>instruct</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;instruction&quot;</span><span class=p>:</span> <span class=s2>&quot;Research and compare Python web frameworks&quot;</span><span class=p>},</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>    <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=p>):</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Step completed: </span><span class=si>{</span><span class=n>step</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=act>act<a class=headerlink href=#act title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>act</span><span class=p>(</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=n>action_request</span><span class=p>:</span> <span class=nb>list</span> <span class=o>|</span> <span class=n>ActionRequest</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>|</span> <span class=nb>dict</span><span class=p>,</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=o>*</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>strategy</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;concurrent&quot;</span><span class=p>,</span> <span class=s2>&quot;sequential&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;concurrent&quot;</span><span class=p>,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>verbose_action</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>suppress_errors</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>call_params</span><span class=p>:</span> <span class=n>AlcallParams</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>ActionResponse</span><span class=p>]</span>
</span></code></pre></div> <p>Directly invokes tool actions without an LLM call. Useful for executing tool calls programmatically.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>action_request</code></td> <td><code>list \| ActionRequest \| BaseModel \| dict</code></td> <td><em>(required)</em></td> <td>Tool call request(s) to execute.</td> </tr> <tr> <td><code>strategy</code></td> <td><code>"concurrent" \| "sequential"</code></td> <td><code>"concurrent"</code></td> <td>Execution strategy.</td> </tr> <tr> <td><code>verbose_action</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Log action details.</td> </tr> <tr> <td><code>suppress_errors</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Suppress exceptions from tool calls.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>list[ActionResponse]</code></p> <hr> <h4 id=interpret>interpret<a class=headerlink href=#interpret title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>interpret</span><span class=p>(</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>    <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=n>domain</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=n>style</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>    <span class=n>interpret_model</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span>
</span></code></pre></div> <p>Rewrites raw user input into a clearer, more structured LLM prompt. Does <strong>not</strong> add messages to the conversation.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>text</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Raw user input to rewrite.</td> </tr> <tr> <td><code>domain</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Domain hint (e.g., <code>"finance"</code>, <code>"devops"</code>).</td> </tr> <tr> <td><code>style</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Style hint (e.g., <code>"concise"</code>, <code>"detailed"</code>).</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>str</code> -- the refined prompt.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=n>refined</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>interpret</span><span class=p>(</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>    <span class=s2>&quot;how do i do marketing stuff&quot;</span><span class=p>,</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>    <span class=n>domain</span><span class=o>=</span><span class=s2>&quot;marketing&quot;</span><span class=p>,</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=n>style</span><span class=o>=</span><span class=s2>&quot;detailed&quot;</span><span class=p>,</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=p>)</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=c1># =&gt; &quot;Explain step-by-step how to set up a marketing analytics pipeline...&quot;</span>
</span></code></pre></div> <hr> <h4 id=register_tools>register_tools<a class=headerlink href=#register_tools title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=k>def</span><span class=w> </span><span class=nf>register_tools</span><span class=p>(</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>FuncTool</span> <span class=o>|</span> <span class=nb>list</span><span class=p>[</span><span class=n>FuncTool</span><span class=p>]</span> <span class=o>|</span> <span class=n>LionTool</span><span class=p>,</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=n>update</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Registers one or more tools (functions or <code>Tool</code> objects) in the branch.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>tools</code></td> <td><code>FuncTool \| list[FuncTool] \| LionTool</code></td> <td><em>(required)</em></td> <td>Tool(s) to register. Can be plain functions, <code>Tool</code> instances, or <code>LionTool</code> subclasses.</td> </tr> <tr> <td><code>update</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Overwrite existing tools with the same name.</td> </tr> </tbody> </table> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>def</span><span class=w> </span><span class=nf>multiply</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=k>return</span> <span class=n>x</span> <span class=o>*</span> <span class=n>y</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>branch</span><span class=o>.</span><span class=n>register_tools</span><span class=p>([</span><span class=n>multiply</span><span class=p>])</span>
</span></code></pre></div> <hr> <h4 id=get_operation>get_operation<a class=headerlink href=#get_operation title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_operation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Callable</span> <span class=o>|</span> <span class=kc>None</span>
</span></code></pre></div> <p>Looks up an operation by name. First checks for a method on the Branch, then falls back to the operation registry.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>operation</code> (<code>str</code>): Operation name (e.g., <code>"chat"</code>, <code>"communicate"</code>).</li> </ul> <p><strong>Returns:</strong> <code>Callable | None</code></p> <hr> <h4 id=clone>clone<a class=headerlink href=#clone title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>def</span><span class=w> </span><span class=nf>clone</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sender</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Creates a synchronous copy of the branch, including messages, system config, tools, and models. API-backed models are shared; CLI-backed models get fresh copies.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>sender</code> (<code>ID.Ref</code>, optional): New sender ID for all cloned messages.</li> </ul> <p><strong>Returns:</strong> <code>Branch</code> -- a new branch instance.</p> <hr> <h4 id=aclone>aclone<a class=headerlink href=#aclone title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>aclone</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sender</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Async variant of <code>clone</code>. Acquires the message lock before cloning.</p> <p><strong>Returns:</strong> <code>Branch</code></p> <hr> <h4 id=to_dict>to_dict<a class=headerlink href=#to_dict title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>def</span><span class=w> </span><span class=nf>to_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span>
</span></code></pre></div> <p>Serializes the branch to a dictionary including messages, logs, models, system message, log config, and metadata.</p> <p><strong>Returns:</strong> <code>dict</code></p> <hr> <h4 id=from_dict>from_dict<a class=headerlink href=#from_dict title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=nd>@classmethod</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=k>def</span><span class=w> </span><span class=nf>from_dict</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Deserializes a <code>Branch</code> from a dictionary produced by <code>to_dict</code>.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>data</code> (<code>dict</code>): Serialized branch data.</li> </ul> <p><strong>Returns:</strong> <code>Branch</code></p> <hr> <h4 id=to_df>to_df<a class=headerlink href=#to_df title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>def</span><span class=w> </span><span class=nf>to_df</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>progression</span><span class=p>:</span> <span class=n>Progression</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span>
</span></code></pre></div> <p>Converts branch messages to a pandas DataFrame.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>progression</code> (<code>Progression</code>, optional): Custom message ordering.</li> </ul> <p><strong>Returns:</strong> <code>pd.DataFrame</code></p> <hr> <h4 id=dump_logs-adump_logs>dump_logs / adump_logs<a class=headerlink href=#dump_logs-adump_logs title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>def</span><span class=w> </span><span class=nf>dump_logs</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>clear</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>persist_path</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>adump_logs</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>clear</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>persist_path</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Writes logs to disk. If <code>clear=True</code> (default), clears the in-memory log after writing.</p> <hr> <h2 id=session>Session<a class=headerlink href=#session title="Permanent link">&para;</a></h2> <p>Manages multiple <code>Branch</code> instances and executes graph-based workflows. Creates a default branch automatically on initialization.</p> <h3 id=constructor_1>Constructor<a class=headerlink href=#constructor_1 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=n>Session</span><span class=p>(</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>    <span class=n>branches</span><span class=p>:</span> <span class=n>Pile</span><span class=p>[</span><span class=n>Branch</span><span class=p>]</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>    <span class=n>default_branch</span><span class=p>:</span> <span class=n>Branch</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;Session&quot;</span><span class=p>,</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>    <span class=n>user</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>branches</code></td> <td><code>Pile[Branch]</code></td> <td>auto</td> <td>Collection of branches. A default empty <code>Pile</code> is created.</td> </tr> <tr> <td><code>default_branch</code></td> <td><code>Branch \| None</code></td> <td><code>None</code></td> <td>Primary branch. Created automatically if <code>None</code>.</td> </tr> <tr> <td><code>name</code></td> <td><code>str</code></td> <td><code>"Session"</code></td> <td>Session name.</td> </tr> <tr> <td><code>user</code></td> <td><code>SenderRecipient \| None</code></td> <td><code>None</code></td> <td>User/owner of the session. Propagated to branches.</td> </tr> </tbody> </table> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Session</span><span class=p>,</span> <span class=n>iModel</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=n>session</span> <span class=o>=</span> <span class=n>Session</span><span class=p>()</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># session.default_branch is ready to use</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>session</span><span class=o>.</span><span class=n>default_branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span><span class=s2>&quot;Hello!&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=properties_1>Properties<a class=headerlink href=#properties_1 title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>branches</code></td> <td><code>Pile[Branch]</code></td> <td>All branches in the session.</td> </tr> <tr> <td><code>default_branch</code></td> <td><code>Branch</code></td> <td>The active default branch.</td> </tr> <tr> <td><code>name</code></td> <td><code>str</code></td> <td>Session name.</td> </tr> <tr> <td><code>user</code></td> <td><code>SenderRecipient \| None</code></td> <td>Session owner.</td> </tr> </tbody> </table> <h3 id=methods_1>Methods<a class=headerlink href=#methods_1 title="Permanent link">&para;</a></h3> <hr> <h4 id=flow>flow<a class=headerlink href=#flow title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>flow</span><span class=p>(</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>    <span class=n>graph</span><span class=p>:</span> <span class=n>Graph</span><span class=p>,</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>    <span class=o>*</span><span class=p>,</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>    <span class=n>context</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>    <span class=n>parallel</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=n>max_concurrent</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span><span class=p>,</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>    <span class=n>default_branch</span><span class=p>:</span> <span class=n>Branch</span> <span class=o>|</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>    <span class=n>alcall_params</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
</span></code></pre></div> <p>Executes a graph-based workflow using multi-branch orchestration. Independent operations run in parallel; dependent operations run sequentially.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>graph</code></td> <td><code>Graph</code></td> <td><em>(required)</em></td> <td>Workflow graph containing <code>Operation</code> nodes.</td> </tr> <tr> <td><code>context</code></td> <td><code>dict</code></td> <td><code>None</code></td> <td>Initial context passed to operations.</td> </tr> <tr> <td><code>parallel</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Run independent operations concurrently.</td> </tr> <tr> <td><code>max_concurrent</code></td> <td><code>int</code></td> <td><code>5</code></td> <td>Max concurrent branches.</td> </tr> <tr> <td><code>verbose</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Enable verbose logging.</td> </tr> <tr> <td><code>default_branch</code></td> <td><code>Branch \| ID.Ref</code></td> <td><code>None</code></td> <td>Branch override (defaults to <code>self.default_branch</code>).</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>dict[str, Any]</code> -- execution results with completed operations and final context.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Session</span><span class=p>,</span> <span class=n>Builder</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=n>session</span> <span class=o>=</span> <span class=n>Session</span><span class=p>()</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=n>builder</span> <span class=o>=</span> <span class=n>Builder</span><span class=p>()</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=n>step1</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span><span class=s2>&quot;communicate&quot;</span><span class=p>,</span> <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Brainstorm ideas&quot;</span><span class=p>)</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=n>step2</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>    <span class=s2>&quot;communicate&quot;</span><span class=p>,</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Evaluate the ideas&quot;</span><span class=p>,</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>    <span class=n>depends_on</span><span class=o>=</span><span class=p>[</span><span class=n>step1</span><span class=p>],</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>    <span class=n>inherit_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=p>)</span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>session</span><span class=o>.</span><span class=n>flow</span><span class=p>(</span><span class=n>builder</span><span class=o>.</span><span class=n>get_graph</span><span class=p>())</span>
</span></code></pre></div> <hr> <h4 id=new_branch>new_branch<a class=headerlink href=#new_branch title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=k>def</span><span class=w> </span><span class=nf>new_branch</span><span class=p>(</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>    <span class=n>system</span><span class=p>:</span> <span class=n>System</span> <span class=o>|</span> <span class=n>JsonValue</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>    <span class=n>system_sender</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>    <span class=n>system_datetime</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>|</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>    <span class=n>user</span><span class=p>:</span> <span class=n>SenderRecipient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>    <span class=n>imodel</span><span class=p>:</span> <span class=n>iModel</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>    <span class=n>messages</span><span class=p>:</span> <span class=n>Pile</span><span class=p>[</span><span class=n>RoledMessage</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>    <span class=n>progress</span><span class=p>:</span> <span class=n>Progression</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=n>tool_manager</span><span class=p>:</span> <span class=n>ActionManager</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>Tool</span> <span class=o>|</span> <span class=n>Callable</span> <span class=o>|</span> <span class=nb>list</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>    <span class=n>as_default_branch</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Creates a new branch and includes it in the session.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>system</code></td> <td><code>System \| JsonValue</code></td> <td><code>None</code></td> <td>System message for the new branch.</td> </tr> <tr> <td><code>name</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Branch name.</td> </tr> <tr> <td><code>imodel</code></td> <td><code>iModel</code></td> <td><code>None</code></td> <td>Model for the branch.</td> </tr> <tr> <td><code>tools</code></td> <td><code>Tool \| Callable \| list</code></td> <td><code>None</code></td> <td>Tools to register.</td> </tr> <tr> <td><code>as_default_branch</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Make this the session's default branch.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>Branch</code></p> <hr> <h4 id=get_branch>get_branch<a class=headerlink href=#get_branch title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_branch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span> <span class=o>|</span> <span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=o>...</span><span class=p>,</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Retrieves a branch by UUID or name. Raises <code>ItemNotFoundError</code> if not found and no default is given.</p> <hr> <h4 id=split-asplit>split / asplit<a class=headerlink href=#split-asplit title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>def</span><span class=w> </span><span class=nf>split</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>asplit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Branch</span>
</span></code></pre></div> <p>Clones a branch and includes the clone in the session.</p> <p><strong>Returns:</strong> <code>Branch</code> -- the newly created clone.</p> <hr> <h4 id=remove_branch>remove_branch<a class=headerlink href=#remove_branch title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>def</span><span class=w> </span><span class=nf>remove_branch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span><span class=p>,</span> <span class=n>delete</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Removes a branch from the session. If the removed branch was the default, the first remaining branch becomes the new default.</p> <hr> <h4 id=change_default_branch>change_default_branch<a class=headerlink href=#change_default_branch title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>def</span><span class=w> </span><span class=nf>change_default_branch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>Ref</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Sets a different branch as the session default.</p> <hr> <h4 id=register_operation>register_operation<a class=headerlink href=#register_operation title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>def</span><span class=w> </span><span class=nf>register_operation</span><span class=p>(</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>func</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>update</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Registers a custom operation callable, accessible from all branches in the session.</p> <hr> <h4 id=operation-decorator>operation (decorator)<a class=headerlink href=#operation-decorator title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=nd>@session</span><span class=o>.</span><span class=n>operation</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>update</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>my_custom_op</span><span class=p>():</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>    <span class=o>...</span>
</span></code></pre></div> <p>Decorator to register a function as a named operation on the session.</p> <hr> <h4 id=concat_messages>concat_messages<a class=headerlink href=#concat_messages title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=k>def</span><span class=w> </span><span class=nf>concat_messages</span><span class=p>(</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>    <span class=n>branches</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>RefSeq</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>    <span class=n>exclude_clone</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>    <span class=n>exclude_load</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pile</span><span class=p>[</span><span class=n>RoledMessage</span><span class=p>]</span>
</span></code></pre></div> <p>Concatenates messages from multiple branches into a single <code>Pile</code>.</p> <hr> <h4 id=to_df_1>to_df<a class=headerlink href=#to_df_1 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=k>def</span><span class=w> </span><span class=nf>to_df</span><span class=p>(</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>    <span class=n>branches</span><span class=p>:</span> <span class=n>ID</span><span class=o>.</span><span class=n>RefSeq</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>    <span class=n>exclude_clone</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>    <span class=n>exlcude_load</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span>
</span></code></pre></div> <p>Converts session messages across branches into a DataFrame.</p> <hr> <h2 id=imodel>iModel<a class=headerlink href=#imodel title="Permanent link">&para;</a></h2> <p>Unified provider interface for LLM API calls with rate limiting, retry logic, and hook support. Supports OpenAI, Anthropic, Gemini, Ollama, NVIDIA NIM, Perplexity, Groq, OpenRouter, and Claude Code CLI.</p> <h3 id=constructor_2>Constructor<a class=headerlink href=#constructor_2 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=n>iModel</span><span class=p>(</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>    <span class=n>provider</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>    <span class=n>base_url</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a>    <span class=n>endpoint</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Endpoint</span> <span class=o>=</span> <span class=s2>&quot;chat&quot;</span><span class=p>,</span>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a>    <span class=n>api_key</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a>    <span class=n>queue_capacity</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a>    <span class=n>capacity_refresh_time</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>60</span><span class=p>,</span>
</span><span id=__span-39-8><a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a>    <span class=n>interval</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-9><a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a>    <span class=n>limit_requests</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-10><a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a>    <span class=n>limit_tokens</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-11><a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a>    <span class=n>concurrency_limit</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-12><a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a>    <span class=n>streaming_process_func</span><span class=p>:</span> <span class=n>Callable</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-13><a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a>    <span class=n>provider_metadata</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-14><a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a>    <span class=n>hook_registry</span><span class=p>:</span> <span class=n>HookRegistry</span> <span class=o>|</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-15><a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a>    <span class=n>exit_hook</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-39-16><a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a>    <span class=nb>id</span><span class=p>:</span> <span class=n>UUID</span> <span class=o>|</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-17><a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a>    <span class=n>created_at</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-39-18><a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-39-19><a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>provider</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Provider name: <code>"openai"</code>, <code>"anthropic"</code>, <code>"gemini"</code>, <code>"ollama"</code>, <code>"claude_code"</code>, etc. Can also be inferred from <code>model</code> if given as <code>"provider/model"</code>.</td> </tr> <tr> <td><code>base_url</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Custom API base URL.</td> </tr> <tr> <td><code>endpoint</code></td> <td><code>str \| Endpoint</code></td> <td><code>"chat"</code></td> <td>Endpoint type or a pre-built <code>Endpoint</code> instance.</td> </tr> <tr> <td><code>api_key</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>API key. Falls back to environment variables.</td> </tr> <tr> <td><code>queue_capacity</code></td> <td><code>int</code></td> <td><code>None</code></td> <td>Max queued requests before execution.</td> </tr> <tr> <td><code>capacity_refresh_time</code></td> <td><code>float</code></td> <td><code>60</code></td> <td>Seconds between queue capacity resets.</td> </tr> <tr> <td><code>interval</code></td> <td><code>float</code></td> <td><code>None</code></td> <td>Request processing interval. Defaults to <code>capacity_refresh_time</code>.</td> </tr> <tr> <td><code>limit_requests</code></td> <td><code>int</code></td> <td><code>None</code></td> <td>Max requests per cycle.</td> </tr> <tr> <td><code>limit_tokens</code></td> <td><code>int</code></td> <td><code>None</code></td> <td>Max tokens per cycle.</td> </tr> <tr> <td><code>concurrency_limit</code></td> <td><code>int</code></td> <td><code>None</code></td> <td>Max concurrent streaming requests (CLI only).</td> </tr> <tr> <td><code>streaming_process_func</code></td> <td><code>Callable</code></td> <td><code>None</code></td> <td>Custom function to process streaming chunks.</td> </tr> <tr> <td><code>provider_metadata</code></td> <td><code>dict</code></td> <td><code>None</code></td> <td>Provider-specific metadata (e.g., session IDs).</td> </tr> <tr> <td><code>hook_registry</code></td> <td><code>HookRegistry \| dict</code></td> <td><code>None</code></td> <td>Pre/post-invocation hooks.</td> </tr> <tr> <td><code>exit_hook</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Enable exit hooks on invocation.</td> </tr> <tr> <td><code>**kwargs</code></td> <td></td> <td></td> <td>Provider-specific parameters (e.g., <code>model</code>, <code>temperature</code>, <code>max_tokens</code>).</td> </tr> </tbody> </table> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>iModel</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=c1># OpenAI</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=n>model</span> <span class=o>=</span> <span class=n>iModel</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4.1-mini&quot;</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=c1># Anthropic</span>
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=n>model</span> <span class=o>=</span> <span class=n>iModel</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=s2>&quot;anthropic&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;claude-sonnet-4-20250514&quot;</span><span class=p>)</span>
</span><span id=__span-40-8><a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>
</span><span id=__span-40-9><a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=c1># Shorthand: provider/model</span>
</span><span id=__span-40-10><a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=n>model</span> <span class=o>=</span> <span class=n>iModel</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;openai/gpt-4.1-mini&quot;</span><span class=p>)</span>
</span><span id=__span-40-11><a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a>
</span><span id=__span-40-12><a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a><span class=c1># Ollama (local)</span>
</span><span id=__span-40-13><a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a><span class=n>model</span> <span class=o>=</span> <span class=n>iModel</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=s2>&quot;ollama&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;llama3&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=async-context-manager_1>Async Context Manager<a class=headerlink href=#async-context-manager_1 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=k>async</span> <span class=k>with</span> <span class=n>iModel</span><span class=p>(</span><span class=n>provider</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4.1-mini&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>model</span><span class=p>:</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>model</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>messages</span><span class=o>=</span><span class=p>[</span><span class=o>...</span><span class=p>])</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=c1># executor is stopped and resources released on exit</span>
</span></code></pre></div> <h3 id=properties_2>Properties<a class=headerlink href=#properties_2 title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>id</code></td> <td><code>UUID</code></td> <td>Unique model instance identifier.</td> </tr> <tr> <td><code>created_at</code></td> <td><code>float</code></td> <td>Creation timestamp.</td> </tr> <tr> <td><code>endpoint</code></td> <td><code>Endpoint</code></td> <td>The configured endpoint.</td> </tr> <tr> <td><code>executor</code></td> <td><code>RateLimitedAPIExecutor</code></td> <td>Rate-limited request executor.</td> </tr> <tr> <td><code>is_cli</code></td> <td><code>bool</code></td> <td>Whether this model uses a CLI endpoint.</td> </tr> <tr> <td><code>model_name</code></td> <td><code>str</code></td> <td>The model name string (e.g., <code>"gpt-4.1-mini"</code>).</td> </tr> <tr> <td><code>request_options</code></td> <td><code>type[BaseModel] \| None</code></td> <td>Request schema for the endpoint.</td> </tr> <tr> <td><code>hook_registry</code></td> <td><code>HookRegistry</code></td> <td>Registered hooks.</td> </tr> </tbody> </table> <h3 id=methods_2>Methods<a class=headerlink href=#methods_2 title="Permanent link">&para;</a></h3> <hr> <h4 id=invoke>invoke<a class=headerlink href=#invoke title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>api_call</span><span class=p>:</span> <span class=n>APICalling</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>APICalling</span>
</span></code></pre></div> <p>Performs a rate-limited API call. Starts the executor if needed, enqueues the request, and waits for completion.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>api_call</code> (<code>APICalling</code>, optional): Pre-built API call. If <code>None</code>, one is created from <code>**kw</code>.</li> <li><code>**kw</code>: Request parameters (e.g., <code>messages</code>, <code>temperature</code>).</li> </ul> <p><strong>Returns:</strong> <code>APICalling</code> -- the completed call with <code>.response</code> populated.</p> <p><strong>Raises:</strong> <code>ValueError</code> on invocation failure.</p> <hr> <h4 id=stream>stream<a class=headerlink href=#stream title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>stream</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>api_call</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>AsyncGenerator</span>
</span></code></pre></div> <p>Performs a streaming API call, yielding chunks as they arrive.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>api_call</code>: Pre-built API call. If <code>None</code>, one is created with <code>stream=True</code>.</li> <li><code>**kw</code>: Request parameters.</li> </ul> <p><strong>Yields:</strong> Processed chunks (via <code>streaming_process_func</code> if set) or raw chunks. The final yield is the completed <code>APICalling</code> object.</p> <hr> <h4 id=create_api_calling>create_api_calling<a class=headerlink href=#create_api_calling title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=k>def</span><span class=w> </span><span class=nf>create_api_calling</span><span class=p>(</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>    <span class=n>include_token_usage_to_model</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>APICalling</span>
</span></code></pre></div> <p>Builds an <code>APICalling</code> event from keyword arguments using the configured endpoint.</p> <p><strong>Returns:</strong> <code>APICalling</code></p> <hr> <h4 id=create_event>create_event<a class=headerlink href=#create_event title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>create_event</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>    <span class=n>create_event_type</span><span class=p>:</span> <span class=nb>type</span><span class=p>[</span><span class=n>Event</span><span class=p>]</span> <span class=o>=</span> <span class=n>APICalling</span><span class=p>,</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>    <span class=n>create_event_exit_hook</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>    <span class=n>create_event_hook_timeout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>10.0</span><span class=p>,</span>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a>    <span class=n>create_event_hook_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-7><a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a>    <span class=n>pre_invoke_event_exit_hook</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-8><a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a>    <span class=n>pre_invoke_event_hook_timeout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>30.0</span><span class=p>,</span>
</span><span id=__span-45-9><a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a>    <span class=n>pre_invoke_event_hook_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-10><a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a>    <span class=n>post_invoke_event_exit_hook</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-11><a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a>    <span class=n>post_invoke_event_hook_timeout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>30.0</span><span class=p>,</span>
</span><span id=__span-45-12><a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a>    <span class=n>post_invoke_event_hook_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-45-13><a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-45-14><a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>APICalling</span>
</span></code></pre></div> <p>Creates an API call event with optional pre/post-invocation hooks. Used internally by <code>invoke()</code> and <code>stream()</code>.</p> <hr> <h4 id=process_chunk>process_chunk<a class=headerlink href=#process_chunk title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>process_chunk</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>chunk</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span>
</span></code></pre></div> <p>Processes a single streaming chunk. Override this or provide <code>streaming_process_func</code> for custom chunk handling.</p> <hr> <h4 id=copy>copy<a class=headerlink href=#copy title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=k>def</span><span class=w> </span><span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>share_session</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>iModel</span>
</span></code></pre></div> <p>Creates a new <code>iModel</code> with the same configuration but a fresh ID and executor.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>share_session</code> (<code>bool</code>): If <code>True</code>, carries over CLI session state.</li> </ul> <p><strong>Returns:</strong> <code>iModel</code></p> <hr> <h4 id=close>close<a class=headerlink href=#close title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>close</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Stops the executor and releases resources.</p> <hr> <h4 id=to_dict-from_dict>to_dict / from_dict<a class=headerlink href=#to_dict-from_dict title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=k>def</span><span class=w> </span><span class=nf>to_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=nd>@classmethod</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=k>def</span><span class=w> </span><span class=nf>from_dict</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>iModel</span>
</span></code></pre></div> <p>Serialization and deserialization. The dict includes <code>id</code>, <code>created_at</code>, <code>endpoint</code> config, <code>processor_config</code>, and <code>provider_metadata</code>.</p> <hr> <h2 id=builder>Builder<a class=headerlink href=#builder title="Permanent link">&para;</a></h2> <p><code>OperationGraphBuilder</code> (aliased as <code>Builder</code>) constructs directed acyclic graphs of operations for execution by <code>Session.flow()</code>. Supports incremental build-execute-expand cycles.</p> <h3 id=constructor_3>Constructor<a class=headerlink href=#constructor_3 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=n>Builder</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;DynamicGraph&quot;</span><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>str</code></td> <td><code>"DynamicGraph"</code></td> <td>Name for the graph.</td> </tr> </tbody> </table> <h3 id=attributes>Attributes<a class=headerlink href=#attributes title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>graph</code></td> <td><code>Graph</code></td> <td>The underlying directed graph.</td> </tr> <tr> <td><code>last_operation_id</code></td> <td><code>str \| None</code></td> <td>ID of the most recently added operation.</td> </tr> </tbody> </table> <h3 id=methods_3>Methods<a class=headerlink href=#methods_3 title="Permanent link">&para;</a></h3> <hr> <h4 id=add_operation>add_operation<a class=headerlink href=#add_operation title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=k>def</span><span class=w> </span><span class=nf>add_operation</span><span class=p>(</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>    <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-51-4><a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a>    <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-51-5><a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a>    <span class=n>depends_on</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-51-6><a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a>    <span class=n>inherit_context</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-51-7><a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a>    <span class=n>branch</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-51-8><a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a>    <span class=o>**</span><span class=n>parameters</span><span class=p>,</span>
</span><span id=__span-51-9><a id=__codelineno-51-9 name=__codelineno-51-9 href=#__codelineno-51-9></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span>
</span></code></pre></div> <p>Adds an operation node to the graph. If no <code>depends_on</code> is specified, the node is linked sequentially from the current head nodes.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>operation</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Branch operation name: <code>"chat"</code>, <code>"communicate"</code>, <code>"operate"</code>, <code>"ReAct"</code>, etc.</td> </tr> <tr> <td><code>node_id</code></td> <td><code>str</code></td> <td><code>None</code></td> <td>Reference ID for later lookup.</td> </tr> <tr> <td><code>depends_on</code></td> <td><code>list[str]</code></td> <td><code>None</code></td> <td>Node IDs this operation depends on.</td> </tr> <tr> <td><code>inherit_context</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Inherit conversation context from the primary dependency.</td> </tr> <tr> <td><code>branch</code></td> <td><code>Branch \| ID.Ref</code></td> <td><code>None</code></td> <td>Specific branch to run on.</td> </tr> <tr> <td><code>**parameters</code></td> <td></td> <td></td> <td>Operation parameters (e.g., <code>instruction</code>, <code>response_format</code>).</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>str</code> -- UUID of the created operation node.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Builder</span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a><span class=n>builder</span> <span class=o>=</span> <span class=n>Builder</span><span class=p>()</span>
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=n>step1</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span><span class=s2>&quot;communicate&quot;</span><span class=p>,</span> <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;List 5 ideas&quot;</span><span class=p>)</span>
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a><span class=n>step2</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a>    <span class=s2>&quot;communicate&quot;</span><span class=p>,</span>
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Evaluate these ideas&quot;</span><span class=p>,</span>
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a>    <span class=n>depends_on</span><span class=o>=</span><span class=p>[</span><span class=n>step1</span><span class=p>],</span>
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a>    <span class=n>inherit_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-52-10><a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=add_aggregation>add_aggregation<a class=headerlink href=#add_aggregation title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=k>def</span><span class=w> </span><span class=nf>add_aggregation</span><span class=p>(</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a>    <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>    <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a>    <span class=n>source_node_ids</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a>    <span class=n>inherit_context</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a>    <span class=n>inherit_from_source</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a>    <span class=n>branch</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-53-9><a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a>    <span class=o>**</span><span class=n>parameters</span><span class=p>,</span>
</span><span id=__span-53-10><a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span>
</span></code></pre></div> <p>Adds a node that aggregates results from multiple source nodes (defaults to current head nodes).</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>operation</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>The aggregation operation.</td> </tr> <tr> <td><code>source_node_ids</code></td> <td><code>list[str]</code></td> <td><code>None</code></td> <td>Nodes to aggregate from. Defaults to current heads.</td> </tr> <tr> <td><code>inherit_context</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Inherit context from one source.</td> </tr> <tr> <td><code>inherit_from_source</code></td> <td><code>int</code></td> <td><code>0</code></td> <td>Index of the source to inherit from.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>str</code> -- UUID of the aggregation node.</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=c1># Fan-out then aggregate</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a><span class=n>nodes</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=k>for</span> <span class=n>topic</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;AI&quot;</span><span class=p>,</span> <span class=s2>&quot;ML&quot;</span><span class=p>,</span> <span class=s2>&quot;NLP&quot;</span><span class=p>]:</span>
</span><span id=__span-54-4><a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a>    <span class=n>nodes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span><span class=s2>&quot;communicate&quot;</span><span class=p>,</span> <span class=n>instruction</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Research </span><span class=si>{</span><span class=n>topic</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>))</span>
</span><span id=__span-54-5><a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a>
</span><span id=__span-54-6><a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a><span class=n>synthesis</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>add_aggregation</span><span class=p>(</span>
</span><span id=__span-54-7><a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a>    <span class=s2>&quot;communicate&quot;</span><span class=p>,</span>
</span><span id=__span-54-8><a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a>    <span class=n>source_node_ids</span><span class=o>=</span><span class=n>nodes</span><span class=p>,</span>
</span><span id=__span-54-9><a id=__codelineno-54-9 name=__codelineno-54-9 href=#__codelineno-54-9></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Synthesize findings&quot;</span><span class=p>,</span>
</span><span id=__span-54-10><a id=__codelineno-54-10 name=__codelineno-54-10 href=#__codelineno-54-10></a><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=expand_from_result>expand_from_result<a class=headerlink href=#expand_from_result title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=k>def</span><span class=w> </span><span class=nf>expand_from_result</span><span class=p>(</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a>    <span class=n>items</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Any</span><span class=p>],</span>
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a>    <span class=n>source_node_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a>    <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a>    <span class=n>strategy</span><span class=p>:</span> <span class=n>ExpansionStrategy</span> <span class=o>=</span> <span class=n>ExpansionStrategy</span><span class=o>.</span><span class=n>CONCURRENT</span><span class=p>,</span>
</span><span id=__span-55-7><a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a>    <span class=n>inherit_context</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-55-8><a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a>    <span class=n>chain_context</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-55-9><a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a>    <span class=o>**</span><span class=n>shared_params</span><span class=p>,</span>
</span><span id=__span-55-10><a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
</span></code></pre></div> <p>Expands the graph based on execution results. Creates new operation nodes for each item in <code>items</code>, linked from the source node.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>items</code></td> <td><code>list[Any]</code></td> <td><em>(required)</em></td> <td>Items to expand (e.g., from a previous result).</td> </tr> <tr> <td><code>source_node_id</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Node that produced the items.</td> </tr> <tr> <td><code>operation</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Operation to apply to each item.</td> </tr> <tr> <td><code>strategy</code></td> <td><code>ExpansionStrategy</code></td> <td><code>CONCURRENT</code></td> <td><code>CONCURRENT</code> or <code>SEQUENTIAL</code>.</td> </tr> <tr> <td><code>inherit_context</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Inherit context from source.</td> </tr> <tr> <td><code>chain_context</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Chain context between sequential expansions.</td> </tr> </tbody> </table> <p><strong>Returns:</strong> <code>list[str]</code> -- IDs of the new nodes.</p> <hr> <h4 id=add_conditional_branch>add_conditional_branch<a class=headerlink href=#add_conditional_branch title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=k>def</span><span class=w> </span><span class=nf>add_conditional_branch</span><span class=p>(</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a>    <span class=n>condition_check_op</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a>    <span class=n>true_op</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a>    <span class=n>false_op</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>    <span class=o>**</span><span class=n>check_params</span><span class=p>,</span>
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span>
</span></code></pre></div> <p>Adds a conditional branching structure: a check node with <code>true</code> and optional <code>false</code> paths.</p> <p><strong>Returns:</strong> <code>dict</code> with keys <code>"check"</code>, <code>"true"</code>, and optionally <code>"false"</code>, each mapping to a node ID.</p> <hr> <h4 id=get_graph>get_graph<a class=headerlink href=#get_graph title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_graph</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Graph</span>
</span></code></pre></div> <p>Returns the current graph for execution by <code>Session.flow()</code>.</p> <p><strong>Returns:</strong> <code>Graph</code></p> <hr> <h4 id=mark_executed>mark_executed<a class=headerlink href=#mark_executed title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=k>def</span><span class=w> </span><span class=nf>mark_executed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>node_ids</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Marks nodes as executed, useful for incremental build-execute cycles.</p> <hr> <h4 id=get_unexecuted_nodes>get_unexecuted_nodes<a class=headerlink href=#get_unexecuted_nodes title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_unexecuted_nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>Operation</span><span class=p>]</span>
</span></code></pre></div> <p>Returns all operations not yet marked as executed.</p> <hr> <h4 id=get_node_by_reference>get_node_by_reference<a class=headerlink href=#get_node_by_reference title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_node_by_reference</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>reference_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Operation</span> <span class=o>|</span> <span class=kc>None</span>
</span></code></pre></div> <p>Looks up a node by its <code>node_id</code> reference (set via <code>add_operation</code>).</p> <hr> <h4 id=visualize_state>visualize_state<a class=headerlink href=#visualize_state title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=k>def</span><span class=w> </span><span class=nf>visualize_state</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
</span></code></pre></div> <p>Returns a summary dict with <code>total_nodes</code>, <code>executed_nodes</code>, <code>unexecuted_nodes</code>, <code>current_heads</code>, <code>expansions</code>, and <code>edges</code>.</p> <hr> <h4 id=visualize>visualize<a class=headerlink href=#visualize title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=k>def</span><span class=w> </span><span class=nf>visualize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>title</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;Operation Graph&quot;</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>14</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Renders the graph visually using matplotlib.</p> <hr> <h2 id=operation>Operation<a class=headerlink href=#operation title="Permanent link">&para;</a></h2> <p>A graph node representing a single branch operation. Extends both <code>Node</code> and <code>Event</code>, tracking execution status, timing, and results.</p> <h3 id=constructor_4>Constructor<a class=headerlink href=#constructor_4 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=n>Operation</span><span class=p>(</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a>    <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a>    <span class=n>parameters</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=n>BaseModel</span> <span class=o>=</span> <span class=p>{},</span>
</span><span id=__span-63-4><a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>operation</code></td> <td><code>str</code></td> <td><em>(required)</em></td> <td>Operation name: <code>"chat"</code>, <code>"operate"</code>, <code>"communicate"</code>, <code>"parse"</code>, <code>"ReAct"</code>, <code>"interpret"</code>, <code>"act"</code>, <code>"ReActStream"</code>, or a custom name.</td> </tr> <tr> <td><code>parameters</code></td> <td><code>dict \| BaseModel</code></td> <td><code>{}</code></td> <td>Parameters passed to the operation.</td> </tr> </tbody> </table> <h3 id=properties_3>Properties<a class=headerlink href=#properties_3 title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>branch_id</code></td> <td><code>UUID \| None</code></td> <td>ID of the branch that executed this operation.</td> </tr> <tr> <td><code>graph_id</code></td> <td><code>UUID \| None</code></td> <td>ID of the graph containing this operation.</td> </tr> <tr> <td><code>request</code></td> <td><code>dict</code></td> <td>Parameters as a dictionary.</td> </tr> <tr> <td><code>response</code></td> <td><code>Any</code></td> <td>Execution result (populated after <code>invoke</code>).</td> </tr> </tbody> </table> <h3 id=methods_4>Methods<a class=headerlink href=#methods_4 title="Permanent link">&para;</a></h3> <hr> <h4 id=invoke_1>invoke<a class=headerlink href=#invoke_1 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>branch</span><span class=p>:</span> <span class=n>Branch</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <p>Executes the operation on the given branch. Updates <code>execution.status</code>, <code>execution.response</code>, <code>execution.duration</code>, and <code>execution.error</code>.</p> <p><strong>Parameters:</strong></p> <ul> <li><code>branch</code> (<code>Branch</code>): The branch to execute on.</li> </ul> <hr> <h3 id=factory-function>Factory Function<a class=headerlink href=#factory-function title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi.operations.node</span><span class=w> </span><span class=kn>import</span> <span class=n>create_operation</span>
</span><span id=__span-65-2><a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a>
</span><span id=__span-65-3><a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a><span class=n>op</span> <span class=o>=</span> <span class=n>create_operation</span><span class=p>(</span>
</span><span id=__span-65-4><a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a>    <span class=n>operation</span><span class=o>=</span><span class=s2>&quot;communicate&quot;</span><span class=p>,</span>
</span><span id=__span-65-5><a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a>    <span class=n>parameters</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;instruction&quot;</span><span class=p>:</span> <span class=s2>&quot;Hello&quot;</span><span class=p>},</span>
</span><span id=__span-65-6><a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=p>)</span>
</span></code></pre></div> <hr> <h2 id=pile>Pile<a class=headerlink href=#pile title="Permanent link">&para;</a></h2> <p>Thread-safe, async-compatible ordered collection keyed by UUID. Items are accessed by UUID (not by list index). Supports JSON, CSV, and DataFrame adapters.</p> <h3 id=constructor_5>Constructor<a class=headerlink href=#constructor_5 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=n>Pile</span><span class=p>(</span>
</span><span id=__span-66-2><a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a>    <span class=n>collections</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Element</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-66-3><a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a>    <span class=n>item_type</span><span class=p>:</span> <span class=nb>set</span><span class=p>[</span><span class=nb>type</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-66-4><a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a>    <span class=n>order</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>UUID</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-66-5><a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a>    <span class=n>strict_type</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-66-6><a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a><span class=p>)</span>
</span></code></pre></div> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>collections</code></td> <td><code>list[Element]</code></td> <td><code>None</code></td> <td>Initial items.</td> </tr> <tr> <td><code>item_type</code></td> <td><code>set[type]</code></td> <td><code>None</code></td> <td>Allowed element types.</td> </tr> <tr> <td><code>order</code></td> <td><code>list[UUID]</code></td> <td><code>None</code></td> <td>Explicit ordering.</td> </tr> <tr> <td><code>strict_type</code></td> <td><code>bool</code></td> <td><code>False</code></td> <td>Disallow subtypes if <code>True</code>.</td> </tr> </tbody> </table> <h3 id=key-interface>Key Interface<a class=headerlink href=#key-interface title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Method/Operator</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>pile[uuid]</code></td> <td>Get item by UUID.</td> </tr> <tr> <td><code>pile[0]</code>, <code>pile[1:3]</code></td> <td>Get by index or slice.</td> </tr> <tr> <td><code>pile.include(item)</code></td> <td>Add item if not present.</td> </tr> <tr> <td><code>pile.exclude(item)</code></td> <td>Remove item if present.</td> </tr> <tr> <td><code>pile.pop(key)</code></td> <td>Remove and return item.</td> </tr> <tr> <td><code>pile.get(key, default)</code></td> <td>Get item with fallback.</td> </tr> <tr> <td><code>pile.update(items)</code></td> <td>Update/add items.</td> </tr> <tr> <td><code>pile.insert(index, item)</code></td> <td>Insert at position.</td> </tr> <tr> <td><code>pile.clear()</code></td> <td>Remove all items.</td> </tr> <tr> <td><code>pile.keys()</code></td> <td>All UUIDs in order.</td> </tr> <tr> <td><code>pile.values()</code></td> <td>All items in order.</td> </tr> <tr> <td><code>pile.items()</code></td> <td><code>(UUID, item)</code> pairs in order.</td> </tr> <tr> <td><code>len(pile)</code></td> <td>Number of items.</td> </tr> <tr> <td><code>item in pile</code></td> <td>Membership test.</td> </tr> <tr> <td><code>pile.is_empty()</code></td> <td>Check emptiness.</td> </tr> <tr> <td><code>pile.to_df(columns=...)</code></td> <td>Convert to pandas DataFrame.</td> </tr> <tr> <td><code>pile.dump(path, "json")</code></td> <td>Export to JSON, CSV, or Parquet.</td> </tr> <tr> <td><code>pile \| other</code></td> <td>Union.</td> </tr> <tr> <td><code>pile &amp; other</code></td> <td>Intersection.</td> </tr> <tr> <td><code>pile ^ other</code></td> <td>Symmetric difference.</td> </tr> </tbody> </table> <p>All mutating methods have async variants prefixed with <code>a</code> (e.g., <code>apop</code>, <code>ainclude</code>, <code>aexclude</code>, <code>aclear</code>, <code>aupdate</code>, <code>aget</code>).</p> <p>Pile also works as an async context manager for locked access:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=k>async</span> <span class=k>with</span> <span class=n>pile</span><span class=p>:</span>
</span><span id=__span-67-2><a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a>    <span class=n>pile</span><span class=o>.</span><span class=n>include</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></code></pre></div> <hr> <h2 id=progression>Progression<a class=headerlink href=#progression title="Permanent link">&para;</a></h2> <p>Ordered sequence of UUIDs, decoupled from storage. Multiple progressions can index the same <code>Pile</code> without copying data. Internally backed by <code>collections.deque</code> for O(1) <code>popleft()</code> and <code>append()</code>.</p> <h3 id=constructor_6>Constructor<a class=headerlink href=#constructor_6 title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=n>Progression</span><span class=p>(</span>
</span><span id=__span-68-2><a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a>    <span class=n>order</span><span class=p>:</span> <span class=n>deque</span><span class=p>[</span><span class=n>UUID</span><span class=p>]</span> <span class=o>=</span> <span class=n>deque</span><span class=p>(),</span>
</span><span id=__span-68-3><a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-68-4><a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a><span class=p>)</span>
</span></code></pre></div> <h3 id=key-interface_1>Key Interface<a class=headerlink href=#key-interface_1 title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Method/Operator</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>prog[0]</code>, <code>prog[1:3]</code></td> <td>Index/slice access.</td> </tr> <tr> <td><code>prog.append(item)</code></td> <td>Append UUID(s).</td> </tr> <tr> <td><code>prog.insert(index, item)</code></td> <td>Insert at position.</td> </tr> <tr> <td><code>prog.remove(item)</code></td> <td>Remove first occurrence.</td> </tr> <tr> <td><code>prog.pop(index=-1)</code></td> <td>Remove and return by index.</td> </tr> <tr> <td><code>prog.popleft()</code></td> <td>O(1) remove and return from front.</td> </tr> <tr> <td><code>prog.include(item)</code></td> <td>Add if not present.</td> </tr> <tr> <td><code>prog.exclude(item)</code></td> <td>Remove if present.</td> </tr> <tr> <td><code>prog.clear()</code></td> <td>Remove all.</td> </tr> <tr> <td><code>prog.index(item)</code></td> <td>Find position.</td> </tr> <tr> <td><code>prog.count(item)</code></td> <td>Count occurrences.</td> </tr> <tr> <td><code>prog.extend(other)</code></td> <td>Extend from another Progression.</td> </tr> <tr> <td><code>len(prog)</code></td> <td>Length.</td> </tr> <tr> <td><code>item in prog</code></td> <td>O(1) membership test (via internal set).</td> </tr> <tr> <td><code>prog + other</code></td> <td>Concatenation (new Progression).</td> </tr> <tr> <td><code>prog - other</code></td> <td>Difference (new Progression).</td> </tr> </tbody> </table> <hr> <h2 id=supporting-types>Supporting Types<a class=headerlink href=#supporting-types title="Permanent link">&para;</a></h2> <p>These types are used throughout the API but do not typically need to be instantiated directly.</p> <h3 id=instruct>Instruct<a class=headerlink href=#instruct title="Permanent link">&para;</a></h3> <p>Instruction bundle used by <code>operate</code> and <code>ReAct</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi.operations.fields</span><span class=w> </span><span class=kn>import</span> <span class=n>Instruct</span>
</span><span id=__span-69-2><a id=__codelineno-69-2 name=__codelineno-69-2 href=#__codelineno-69-2></a>
</span><span id=__span-69-3><a id=__codelineno-69-3 name=__codelineno-69-3 href=#__codelineno-69-3></a><span class=n>instruct</span> <span class=o>=</span> <span class=n>Instruct</span><span class=p>(</span>
</span><span id=__span-69-4><a id=__codelineno-69-4 name=__codelineno-69-4 href=#__codelineno-69-4></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Analyze the data&quot;</span><span class=p>,</span>
</span><span id=__span-69-5><a id=__codelineno-69-5 name=__codelineno-69-5 href=#__codelineno-69-5></a>    <span class=n>guidance</span><span class=o>=</span><span class=s2>&quot;Focus on trends&quot;</span><span class=p>,</span>
</span><span id=__span-69-6><a id=__codelineno-69-6 name=__codelineno-69-6 href=#__codelineno-69-6></a>    <span class=n>context</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;data&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]},</span>
</span><span id=__span-69-7><a id=__codelineno-69-7 name=__codelineno-69-7 href=#__codelineno-69-7></a>    <span class=n>reason</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-69-8><a id=__codelineno-69-8 name=__codelineno-69-8 href=#__codelineno-69-8></a><span class=p>)</span>
</span></code></pre></div> <h3 id=element>Element<a class=headerlink href=#element title="Permanent link">&para;</a></h3> <p>Base class for all identifiable objects. Provides <code>id</code> (UUID), <code>created_at</code> (float), and <code>metadata</code> (dict).</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Element</span>
</span><span id=__span-70-2><a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a>
</span><span id=__span-70-3><a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a><span class=n>el</span> <span class=o>=</span> <span class=n>Element</span><span class=p>()</span>
</span><span id=__span-70-4><a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a><span class=nb>print</span><span class=p>(</span><span class=n>el</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>          <span class=c1># UUID</span>
</span><span id=__span-70-5><a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a><span class=nb>print</span><span class=p>(</span><span class=n>el</span><span class=o>.</span><span class=n>created_at</span><span class=p>)</span>  <span class=c1># float timestamp</span>
</span></code></pre></div> <h3 id=node>Node<a class=headerlink href=#node title="Permanent link">&para;</a></h3> <p><code>Element</code> with arbitrary <code>content</code> and optional embedding vector. Used as the base for graph nodes.</p> <h3 id=graph>Graph<a class=headerlink href=#graph title="Permanent link">&para;</a></h3> <p>Directed graph of <code>Node</code> and <code>Edge</code> objects with adjacency tracking.</p> <h3 id=expansionstrategy>ExpansionStrategy<a class=headerlink href=#expansionstrategy title="Permanent link">&para;</a></h3> <p>Enum for <code>Builder.expand_from_result</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi.operations.builder</span><span class=w> </span><span class=kn>import</span> <span class=n>ExpansionStrategy</span>
</span><span id=__span-71-2><a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a>
</span><span id=__span-71-3><a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a><span class=n>ExpansionStrategy</span><span class=o>.</span><span class=n>CONCURRENT</span>             <span class=c1># Run expanded ops in parallel</span>
</span><span id=__span-71-4><a id=__codelineno-71-4 name=__codelineno-71-4 href=#__codelineno-71-4></a><span class=n>ExpansionStrategy</span><span class=o>.</span><span class=n>SEQUENTIAL</span>             <span class=c1># Run expanded ops in sequence</span>
</span><span id=__span-71-5><a id=__codelineno-71-5 name=__codelineno-71-5 href=#__codelineno-71-5></a><span class=n>ExpansionStrategy</span><span class=o>.</span><span class=n>SEQUENTIAL_CONCURRENT_CHUNK</span>
</span><span id=__span-71-6><a id=__codelineno-71-6 name=__codelineno-71-6 href=#__codelineno-71-6></a><span class=n>ExpansionStrategy</span><span class=o>.</span><span class=n>CONCURRENT_SEQUENTIAL_CHUNK</span>
</span></code></pre></div> <hr> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <h3 id=environment-variables>Environment Variables<a class=headerlink href=#environment-variables title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-72-1><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=nb>export</span><span class=w> </span><span class=nv>OPENAI_API_KEY</span><span class=o>=</span><span class=s2>&quot;sk-...&quot;</span>
</span><span id=__span-72-2><a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a><span class=nb>export</span><span class=w> </span><span class=nv>ANTHROPIC_API_KEY</span><span class=o>=</span><span class=s2>&quot;sk-ant-...&quot;</span>
</span><span id=__span-72-3><a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a><span class=nb>export</span><span class=w> </span><span class=nv>GEMINI_API_KEY</span><span class=o>=</span><span class=s2>&quot;...&quot;</span>
</span><span id=__span-72-4><a id=__codelineno-72-4 name=__codelineno-72-4 href=#__codelineno-72-4></a><span class=nb>export</span><span class=w> </span><span class=nv>OLLAMA_BASE_URL</span><span class=o>=</span><span class=s2>&quot;http://localhost:11434&quot;</span><span class=w>  </span><span class=c1># default</span>
</span></code></pre></div> <h3 id=appsettings>AppSettings<a class=headerlink href=#appsettings title="Permanent link">&para;</a></h3> <p>Default model settings are controlled through <code>lionagi.config.settings</code>:</p> <ul> <li><code>LIONAGI_CHAT_PROVIDER</code> -- default: <code>"openai"</code></li> <li><code>LIONAGI_CHAT_MODEL</code> -- default: <code>"gpt-4.1-mini"</code></li> </ul> <p>Override by setting environment variables or passing <code>chat_model</code> to <code>Branch</code>.</p> <hr> <h2 id=quick-reference>Quick Reference<a class=headerlink href=#quick-reference title="Permanent link">&para;</a></h2> <h3 id=common-patterns>Common Patterns<a class=headerlink href=#common-patterns title="Permanent link">&para;</a></h3> <p><strong>Simple conversation:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-73-1><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Branch</span>
</span><span id=__span-73-2><a id=__codelineno-73-2 name=__codelineno-73-2 href=#__codelineno-73-2></a>
</span><span id=__span-73-3><a id=__codelineno-73-3 name=__codelineno-73-3 href=#__codelineno-73-3></a><span class=n>branch</span> <span class=o>=</span> <span class=n>Branch</span><span class=p>(</span><span class=n>system</span><span class=o>=</span><span class=s2>&quot;You are helpful.&quot;</span><span class=p>)</span>
</span><span id=__span-73-4><a id=__codelineno-73-4 name=__codelineno-73-4 href=#__codelineno-73-4></a><span class=n>answer</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span><span class=s2>&quot;What is 2 + 2?&quot;</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Structured output:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-74-1><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span>
</span><span id=__span-74-2><a id=__codelineno-74-2 name=__codelineno-74-2 href=#__codelineno-74-2></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Branch</span>
</span><span id=__span-74-3><a id=__codelineno-74-3 name=__codelineno-74-3 href=#__codelineno-74-3></a>
</span><span id=__span-74-4><a id=__codelineno-74-4 name=__codelineno-74-4 href=#__codelineno-74-4></a><span class=k>class</span><span class=w> </span><span class=nc>Answer</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-74-5><a id=__codelineno-74-5 name=__codelineno-74-5 href=#__codelineno-74-5></a>    <span class=n>value</span><span class=p>:</span> <span class=nb>int</span>
</span><span id=__span-74-6><a id=__codelineno-74-6 name=__codelineno-74-6 href=#__codelineno-74-6></a>    <span class=n>explanation</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-74-7><a id=__codelineno-74-7 name=__codelineno-74-7 href=#__codelineno-74-7></a>
</span><span id=__span-74-8><a id=__codelineno-74-8 name=__codelineno-74-8 href=#__codelineno-74-8></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>communicate</span><span class=p>(</span>
</span><span id=__span-74-9><a id=__codelineno-74-9 name=__codelineno-74-9 href=#__codelineno-74-9></a>    <span class=s2>&quot;What is 2 + 2?&quot;</span><span class=p>,</span>
</span><span id=__span-74-10><a id=__codelineno-74-10 name=__codelineno-74-10 href=#__codelineno-74-10></a>    <span class=n>response_format</span><span class=o>=</span><span class=n>Answer</span><span class=p>,</span>
</span><span id=__span-74-11><a id=__codelineno-74-11 name=__codelineno-74-11 href=#__codelineno-74-11></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Tool use with ReAct:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-75-1><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a><span class=k>def</span><span class=w> </span><span class=nf>calculator</span><span class=p>(</span><span class=n>expression</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-75-2><a id=__codelineno-75-2 name=__codelineno-75-2 href=#__codelineno-75-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Evaluate a math expression.&quot;&quot;&quot;</span>
</span><span id=__span-75-3><a id=__codelineno-75-3 name=__codelineno-75-3 href=#__codelineno-75-3></a>    <span class=k>return</span> <span class=nb>eval</span><span class=p>(</span><span class=n>expression</span><span class=p>)</span>
</span><span id=__span-75-4><a id=__codelineno-75-4 name=__codelineno-75-4 href=#__codelineno-75-4></a>
</span><span id=__span-75-5><a id=__codelineno-75-5 name=__codelineno-75-5 href=#__codelineno-75-5></a><span class=n>branch</span> <span class=o>=</span> <span class=n>Branch</span><span class=p>(</span><span class=n>system</span><span class=o>=</span><span class=s2>&quot;You solve math problems.&quot;</span><span class=p>,</span> <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>calculator</span><span class=p>])</span>
</span><span id=__span-75-6><a id=__codelineno-75-6 name=__codelineno-75-6 href=#__codelineno-75-6></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>branch</span><span class=o>.</span><span class=n>ReAct</span><span class=p>({</span><span class=s2>&quot;instruction&quot;</span><span class=p>:</span> <span class=s2>&quot;What is 15</span><span class=si>% o</span><span class=s2>f 847?&quot;</span><span class=p>})</span>
</span></code></pre></div> <p><strong>Graph workflow:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-76-1><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class=kn>from</span><span class=w> </span><span class=nn>lionagi</span><span class=w> </span><span class=kn>import</span> <span class=n>Session</span><span class=p>,</span> <span class=n>Builder</span>
</span><span id=__span-76-2><a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a>
</span><span id=__span-76-3><a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a><span class=n>session</span> <span class=o>=</span> <span class=n>Session</span><span class=p>()</span>
</span><span id=__span-76-4><a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a><span class=n>builder</span> <span class=o>=</span> <span class=n>Builder</span><span class=p>()</span>
</span><span id=__span-76-5><a id=__codelineno-76-5 name=__codelineno-76-5 href=#__codelineno-76-5></a>
</span><span id=__span-76-6><a id=__codelineno-76-6 name=__codelineno-76-6 href=#__codelineno-76-6></a><span class=c1># Parallel research</span>
</span><span id=__span-76-7><a id=__codelineno-76-7 name=__codelineno-76-7 href=#__codelineno-76-7></a><span class=n>ids</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-76-8><a id=__codelineno-76-8 name=__codelineno-76-8 href=#__codelineno-76-8></a>    <span class=n>builder</span><span class=o>.</span><span class=n>add_operation</span><span class=p>(</span><span class=s2>&quot;communicate&quot;</span><span class=p>,</span> <span class=n>instruction</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Research </span><span class=si>{</span><span class=n>t</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-76-9><a id=__codelineno-76-9 name=__codelineno-76-9 href=#__codelineno-76-9></a>    <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;AI safety&quot;</span><span class=p>,</span> <span class=s2>&quot;AI alignment&quot;</span><span class=p>,</span> <span class=s2>&quot;AI governance&quot;</span><span class=p>]</span>
</span><span id=__span-76-10><a id=__codelineno-76-10 name=__codelineno-76-10 href=#__codelineno-76-10></a><span class=p>]</span>
</span><span id=__span-76-11><a id=__codelineno-76-11 name=__codelineno-76-11 href=#__codelineno-76-11></a>
</span><span id=__span-76-12><a id=__codelineno-76-12 name=__codelineno-76-12 href=#__codelineno-76-12></a><span class=c1># Aggregate</span>
</span><span id=__span-76-13><a id=__codelineno-76-13 name=__codelineno-76-13 href=#__codelineno-76-13></a><span class=n>builder</span><span class=o>.</span><span class=n>add_aggregation</span><span class=p>(</span>
</span><span id=__span-76-14><a id=__codelineno-76-14 name=__codelineno-76-14 href=#__codelineno-76-14></a>    <span class=s2>&quot;communicate&quot;</span><span class=p>,</span>
</span><span id=__span-76-15><a id=__codelineno-76-15 name=__codelineno-76-15 href=#__codelineno-76-15></a>    <span class=n>source_node_ids</span><span class=o>=</span><span class=n>ids</span><span class=p>,</span>
</span><span id=__span-76-16><a id=__codelineno-76-16 name=__codelineno-76-16 href=#__codelineno-76-16></a>    <span class=n>instruction</span><span class=o>=</span><span class=s2>&quot;Synthesize a unified report&quot;</span><span class=p>,</span>
</span><span id=__span-76-17><a id=__codelineno-76-17 name=__codelineno-76-17 href=#__codelineno-76-17></a><span class=p>)</span>
</span><span id=__span-76-18><a id=__codelineno-76-18 name=__codelineno-76-18 href=#__codelineno-76-18></a>
</span><span id=__span-76-19><a id=__codelineno-76-19 name=__codelineno-76-19 href=#__codelineno-76-19></a><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>session</span><span class=o>.</span><span class=n>flow</span><span class=p>(</span><span class=n>builder</span><span class=o>.</span><span class=n>get_graph</span><span class=p>())</span>
</span></code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime" title="February 14, 2026 00:43:09 UTC">2026-02-14 00:43:09</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime" title="August 26, 2025 12:17:31 UTC">2025-08-26 12:17:31</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../for-ai-agents/self-improvement/ class="md-footer__link md-footer__link--prev" aria-label="Previous: State & Debugging"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> State & Debugging </div> </div> </a> <a href=../changelog/ class="md-footer__link md-footer__link--next" aria-label="Next: Changelog"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Changelog </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2026 Ocean Li and LionAGI Contributors </div> </div> <div class=md-social> <a href=https://github.com/khive-ai/lionagi target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/lionagi target=_blank rel=noopener title="Discord Community" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=https://twitter.com/lionagi target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://www.linkedin.com/in/quantoceanli/ target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <button type=reset class="md-button md-button--primary">Reject</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=https://unpkg.com/mermaid@10/dist/mermaid.min.js></script> <script src=../../javascripts/mermaid-config.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>